# å¤©æ°”åŠ©æ‰‹

---

1. å®‰è£…ä¾èµ–

```bash
sudo apt install jq sendemail -y
```

1. è·å–å¤©æ°” API

[https://dev.qweather.com/docs/api/indices/](https://dev.qweather.com/docs/api/indices/)

<aside>
ğŸ’¡ å¯ä»¥ä½¿ç”¨ edge æ’ä»¶è¿›è¡Œ API çš„ GET æ¥å£è°ƒè¯•ï¼Œkeyéœ€è¦è‡ªè¡Œæ³¨å†Œè´¦å·ï¼Œåˆ›å»ºåº”ç”¨è·å–ã€‚

</aside>

![Untitled](./Untitled.png)

1. åˆ›å»ºbashæ–‡ä»¶ï¼Œé”®å…¥ä»¥ä¸‹å†…å®¹

```bash
#!/bin/bash

CITY=101190908   #huai'an
TOKEN=086d5f7edfae48f1b2bc9125d01935db
TYPE=1,8,9

WEATHER=$(curl "https://devapi.qweather.com/v7/indices/1d?location=${CITY}&key=${TOKEN}&type=${TYPE}" | gunzip)

SUGGESTIONS=$(echo ${WEATHER} | jq -r '.daily | values[].text')

#echo ${SUGGESTIONS}

#send msg
SERVER="smtp.qq.com:587"
FROM="1911466766@qq.com"
TO="1911466766@qq.com"
SUBJECT="Weather $(date)"
MESSAGE="${SUGGESTIONS}"
CHARSET="utf-8"
USERNAME="1911466766@qq.com"
PASSWORD="nnsopweppzchbbai"

sendemail \
   -f ${FROM} \
   -t ${TO} \
   -u ${SUBJECT} \
   -s ${SERVER} \
   -m ${MESSAGE} \
   -xu ${USERNAME} \
   -xp ${PASSWORD} \
   -v -o message-charset=${CHARSET}
```

<aside>
ğŸ’¡ æ³¨æ„ï¼Œå¯†ç éœ€å¼€å¯é‚®ç®±çš„smtpæœåŠ¡è·å–,è§ä¸‹é¢é“¾æ¥

</aside>

[å¦‚ä½•æ‰“å¼€POP3/SMTP/IMAPåŠŸèƒ½ï¼Ÿ_QQé‚®ç®±å¸®åŠ©ä¸­å¿ƒ](https://service.mail.qq.com/cgi-bin/help?subtype=1&&no=166&&id=28)

1. é€šè¿‡croné…ç½®æ¯æ—¥å®šæ—¶å‘é€ 

```bash
crontab -e
```

è¿›å…¥ç¼–è¾‘é¡µé¢ï¼ŒåŠ å…¥

![Untitled](./Untitled%201.png)

é‚£ä¹ˆæ¯æ—¥7ï¼š30ä¾¿ä¼šæ”¶åˆ°å¤©æ°”ä¿¡æ¯å•¦ï¼

<aside>
ğŸ’¡ #åœ¨ crontab -e æœ€åä¸€è¡Œè¾“å…¥å‘½ä»¤å³å¯å®ç°ç®€æ˜“å¼€æœºæ‰§è¡Œ
@reboot xxx

</aside>